{% extends 'base.html' %}
{% block title %}{{ item.title }} - Marketplace{% endblock %}
{% block content %}
    <div class="row g-4 align-items-start">
        <div class="col-12 col-md-6">
            {% if item.image %}
                <img src="{{ item.image.url }}" alt="{{ item.title }}" class="img-fluid rounded border">
            {% endif %}
        </div>
        <div class="col-12 col-md-6">
            <h1 class="h3 mb-3">{{ item.title }}</h1>
            <p class="mb-1"><strong>Category:</strong> {{ item.category }}</p>
            <p class="mb-1"><strong>Location:</strong> {{ item.location }}</p>
            <p class="mb-3">{{ item.description }}</p>
            <p class="fs-5 fw-semibold">${{ item.price }}</p>
            
            <!-- Favorite Button -->
            {% if user.is_authenticated and user != object.posted_by %}
                <div class="mb-3">
                    {% if is_favorited %}
                        <form method="post" action="{% url 'remove_favorite' object.pk %}" class="d-inline">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-outline-danger btn-sm">
                                <i class="bi bi-heart-fill"></i> Remove from Favorites
                            </button>
                        </form>
                    {% else %}
                        <form method="post" action="{% url 'add_favorite' object.pk %}" class="d-inline">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-outline-primary btn-sm">
                                <i class="bi bi-heart"></i> Add to Favorites
                            </button>
                        </form>
                    {% endif %}
                </div>
            {% endif %}
            
            {% if user == object.posted_by %}
                <div class="d-flex gap-2 mb-3">
                    <a class="btn btn-primary btn-sm" href="{% url 'item_edit' object.pk %}">Edit</a>
                    <a class="btn btn-outline-danger btn-sm" href="{% url 'item_delete' object.pk %}">Delete</a>
                </div>
            {% endif %}
            <p class="text-muted"><small>Posted by {{ item.posted_by.username }} on {{ item.posted_on|date:"M d, Y" }}</small></p>
            <a class="btn btn-link p-0" href="{% url 'item_list' %}">‚Üê Back to Listings</a>
        </div>
    </div>
{% endblock %}
